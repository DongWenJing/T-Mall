<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.tmall.mapper.ProductMapper">
    <select id="selectProductAll" resultType="Product">
        select * from product
    </select>

<!-- 获取商家商品分类数据   -->
    <select id="findByPage" resultType="Product">

        select product.* from product
        where shop_id=(
            select shop_id from shop
            where owner_id=#{ownerId})
          and product_name like '%${key}%'
          limit #{offset},#{pageSize}
    </select>
<!-- 查询商家的商品条数   -->
    <select id="countShopProduct" resultType="Integer">
        select count(*) from product
        where shop_id=(
            select shop_id from shop
            where owner_id=#{ownerId}
            )
    </select>
<!--修改店铺商品信息    -->
    <update id="updateProduct" >
    UPDATE product SET
                       product_name = #{productName},
                       product_price = #{productPrice},
                       category_id = #{categoryId},
                       weight = #{weight},
                       discount = #{discount},
                       `left` = #{left},
                       product_desc = #{productDesc},
                       img_src = #{imgSrc}
                        WHERE product_id = #{productId}
    </update>
<!--  删除商家商品  -->
    <delete id="deleteProductById" >
        delete from product where product_id=#{productId}
    </delete>

     <insert id="insertProduct">
        INSERT INTO
            product(
                product_id,product_name,product_price,category_id,weight,product_desc,discount,`left`,img_src, shop_id, sold,create_time)
        values(
               null,#{productName},#{productPrice},#{categoryId},#{weight},#{productDesc},#{discount},#{left},#{imgSrc},#{shopId},#{sold},#{createTime})
    </insert>

    <select id="findShopById" resultType="Product">
        select * from product where shop_id=#{shopId}
    </select>

    <select id="showProductInfo" resultType="Product">
        select * from product where product_id=#{productId}
    </select>

    <select id="getHotProduct" resultType="Product">
        select * from product order by sold desc limit 10
    </select>

    <select id="getNewProduct" resultType="Product">
        select * from product where date_format(create_time,'%Y-%m-%d')>= '2022-03-20' limit 10
    </select>

</mapper>